
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Logging Data &#8212; Dripline Controls Guide  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/DL3Logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Process Management" href="process-management.html" />
    <link rel="prev" title="Python Plugin" href="guides/python-plugin.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/DL3Logo.png" alt="Logo"/>
            </a></p>
<h3><a href="index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="guides/guides.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Logging Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#logging-system-general-principles">Logging System General Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#storage-backends">Storage Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="#design-benefits-and-concepts">Design Benefits and Concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="process-management.html">Process Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="command-line-tools.html">Command Line Tools</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="guides/python-plugin.html" title="previous chapter">Python Plugin</a></li>
      <li>Next: <a href="process-management.html" title="next chapter">Process Management</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/logging-data.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<h3>Branches</h3>
<ul>
  <li><a href="logging-data.html">develop</a></li>
  <li><a href="../main/logging-data.html">main</a></li>
</ul>
<h3>Tags</h3>
<ul>
</ul>

        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="logging-data">
<span id="id1"></span><h1>Logging Data<a class="headerlink" href="#logging-data" title="Permalink to this headline">¶</a></h1>
<p>Storing historical data, while a critical piece of a comprehensive controls system, is not inherently part of dripline itself.
Services are generally designed to be self contained and largely stateless; but they can very naturally produce data to be ingested and stored elsewhere.</p>
<div class="section" id="logging-system-general-principles">
<h2>Logging System General Principles<a class="headerlink" href="#logging-system-general-principles" title="Permalink to this headline">¶</a></h2>
<p>When logging data in dripline, there is a deliberate separate of the logic which produces the data to be logged, from the act of actually saving it (typically to some sort of database).
This is achieved by sending messages on the <cite>alerts</cite> exchange.
Each message’s routing key indicates the general type of the data (first word in the routing key) and the specific name for the data (second word in the routing key, often the same as the name of the endpoint sending the data).
For objects one would consider a “sensor” to store scalar values at a regular interval, the existing <cite>Entity</cite> class can be used and takes care of internal timing, as well as providing some logic for non-uniform sampling.
Other common patterns would be:</p>
<ul class="simple">
<li><p>a service which produces an alert message as part of the logic resulting from a received command</p></li>
<li><p>a service which consumes alert messages and produces new alerts messages based on them (logging derived values or converting raw alerts to a log-system compatible form)</p></li>
</ul>
</div>
<div class="section" id="storage-backends">
<h2>Storage Backends<a class="headerlink" href="#storage-backends" title="Permalink to this headline">¶</a></h2>
<p>You can use any storage backend that you prefer.
Most of our existing systems make use postgreSQL, but a service which receives alert messages could put data into whatever system you want (text files, no-SQL database, other SQL database, etc.).</p>
</div>
<div class="section" id="design-benefits-and-concepts">
<h2>Design Benefits and Concepts<a class="headerlink" href="#design-benefits-and-concepts" title="Permalink to this headline">¶</a></h2>
<p>The principles presented here has several benefits, keeping them in mind while putting together a specific system can make life easier as new features are required.</p>
<ol class="arabic simple">
<li><p>Separate out the logging process means that it is easy to have multiple consumers in parallel without them impacting each other</p>
<ol class="arabic simple">
<li><p>This allows testing new databases, database version upgrades, etc., without disrupting the working/production system.</p></li>
<li><p>This allows other services to listen for and respond to new values without needing to interact with the database.</p></li>
</ol>
</li>
<li><p>Have a few, but specialized, database-injection services.</p>
<ol class="arabic simple">
<li><p>Often these are isolated to the type of data they consume (since this may impact where/how they inject the data).</p></li>
<li><p>This service is a place for potential scaling (either database ingestion rate or message processing rate).</p></li>
</ol>
</li>
<li><p>Sensors should be logged individually (that is, there should be independent records for each sensor for each time, so that that data is able to be fully consumed independently).</p></li>
<li><p>Database storage should distinguish between storage of newly measured values, and derived values from existing measurements.
The latter can be useful to log, but are different in nature.</p></li>
<li><p>At least under SQL, the storage design should be driven by how one can “naturally” store the data, with enough context for building relations that exist.
It is almost always a bad idea to design based on how the data will be consumed later (databases provide sophisticated query systems precisely for this purpose).</p></li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020, Driplineorg Maintainers.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/logging-data.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>